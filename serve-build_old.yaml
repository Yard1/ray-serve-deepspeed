# This file was generated using the `serve build` command on Ray v3.0.0.dev0.

import_path: rayviary.app:entrypoint

runtime_env: 
  env_vars:
    APPLICATION_ARGS: |-
      hf_home: /nvme/cache
      model_config:
        batch_size: 1
        dtype: float16
        from_pretrained_kwargs: {}
        generation_kwargs:
          do_sample: true
          max_new_tokens: 256
          top_k: 0
          top_p: 0.92
        mirror_bucket_uri: s3://large-dl-models-mirror/models--stabilityai--stablelm-tuned-alpha-7b/main/
        mode:
          type: DeepSpeed
        name: stabilityai/stablelm-tuned-alpha-7b
        pipeline_cls: stablelm
        prompt_format: null
        stopping_tokens: null
      scaling_config:
        num_workers: 2
        num_gpus_per_worker: 1
        num_cpus_per_worker: 4
    HF_HOME: "/nvme/cache"

host: 0.0.0.0

port: 8000

deployments:

- name: DeepspeedApp
  route_prefix: /
  max_concurrent_queries: 2
  autoscaling_config:
    min_replicas: 2
    initial_replicas: 2
    max_replicas: 32
    target_num_ongoing_requests_per_replica: 1.0
    metrics_interval_s: 10.0
    look_back_period_s: 30.0
    smoothing_factor: 1.0
    downscale_delay_s: 300.0
    upscale_delay_s: 30.0
  ray_actor_options:
    resources:
      worker_node: 0.5
